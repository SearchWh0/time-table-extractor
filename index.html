<!DOCTYPE html>
<html>
<head>
<title>Excel Colour Extractor v1</title>
</head>

<body>

<h2>Paste Excel (Ctrl+V)</h2>

<textarea id="output" rows="20" cols="100"></textarea>

<br><br>

<button onclick="download()">Download CSV</button>

<script>

let result = {};

document.addEventListener("paste", function(e){

let html = e.clipboardData.getData("text/html");

if(!html){

alert("Copy from Excel first");

return;

}

let parser = new DOMParser();

let doc = parser.parseFromString(html, "text/html");

let cells = doc.querySelectorAll("td");

result = {};

cells.forEach(cell=>{

let bg = cell.style.backgroundColor;

let text = cell.innerText.trim();

if(text=="" ) return;

if(bg=="" || bg=="white" || bg=="rgb(255, 255, 255)")
return;


if(!result[bg])
result[bg]=[];

result[bg].push(text);

});


display();

});



function display(){

let text="";

for(let colour in result){

text+="COLOUR: "+colour+"\n";

result[colour].forEach(item=>{

text+=item+"\n";

});

text+="\n";

}

output.value=text;

}



function download(){

let csv="Colour,Text\n";

for(let colour in result){

result[colour].forEach(item=>{

csv+=colour+',"'+item+'"\n';

});

}

let blob=new Blob([csv]);

let a=document.createElement("a");

a.href=URL.createObjectURL(blob);

a.download="excel_colours.csv";

a.click();

}

</script>

</body>
</html>
